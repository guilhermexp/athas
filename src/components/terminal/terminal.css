/* Terminal-specific styles to contain xterm.js - Optimized */
.xterm-container {
  position: relative;
  overflow: hidden;
  width: 100%;
  height: 100%;
  font-family: var(--font-mono) !important;
  font-size: var(--font-size-buffer) !important;
  line-height: var(--line-height-buffer) !important;
  padding: 8px;
  background: var(--color-primary-bg);
  /* Prevent GPU compositing issues */
  will-change: auto;
  transform: translateZ(0);
  display: flex;
  flex-direction: column;
}

/* Ensure xterm doesn't overflow its container */
.xterm-container .xterm {
  flex: 1;
  min-height: 0;
  width: 100% !important;
  font-family: var(--font-mono) !important;
  font-size: var(--font-size-buffer) !important;
  line-height: var(--line-height-buffer) !important;
}

/* Xterm text layer */
.xterm-container .xterm .xterm-rows {
  font-family: var(--font-mono) !important;
  font-size: var(--font-size-buffer) !important;
  line-height: var(--line-height-buffer) !important;
  letter-spacing: 0 !important;
}

/* Override any xterm styles that might cause full-screen issues */
.xterm-container .xterm-screen {
  position: relative !important;
  width: 100% !important;
  height: 100% !important;
}

/* Style the terminal viewport for better appearance */
.xterm-container .xterm-viewport {
  background: transparent !important;
  overflow-y: auto;
}

/* Terminal helper layer */
.xterm-container .xterm-helpers {
  z-index: 10;
}

/* Ensure consistent rendering across all layers */
.xterm-container .xterm-char-measure-element {
  font-family: var(--font-mono) !important;
  font-size: var(--font-size-buffer) !important;
  line-height: var(--line-height-buffer) !important;
}

/* Improve scrollbar styling - Zed style */
.xterm-container .xterm-viewport::-webkit-scrollbar {
  width: 8px;
  background-color: transparent;
}

.xterm-container .xterm-viewport::-webkit-scrollbar-track {
  background-color: transparent;
}

.xterm-container .xterm-viewport::-webkit-scrollbar-thumb {
  background-color: var(--color-border);
  border-radius: 4px;
}

.xterm-container .xterm-viewport::-webkit-scrollbar-thumb:hover {
  background-color: var(--color-text-lighter);
}

/* Terminal cursor - Zed style */
.xterm-container .xterm-cursor-layer {
  z-index: 20;
}

.xterm-container .xterm-cursor {
  mix-blend-mode: difference;
}

/* Selection styling - Zed style */
.xterm-container .xterm-selection-layer {
  z-index: 15;
}

/* Ensure terminal search stays on top */
.terminal-search {
  z-index: 100;
}

/* xterm.js WebLinksAddon - Zed style links */
.xterm .xterm-link-layer {
  z-index: 10;
}

.xterm-screen .xterm-decoration-overview-ruler {
  display: none;
}

.xterm.xterm-cursor-pointer {
  cursor: pointer !important;
}

/* Remove any default padding/margins from xterm internals */
.xterm-container .xterm-rows {
  padding: 0 !important;
  margin: 0 !important;
}

/* Ensure text renders crisply with performance optimizations */
.xterm-container canvas {
  image-rendering: pixelated;
  image-rendering: -moz-crisp-edges;
  image-rendering: crisp-edges;
  /* Optimize for smooth scrolling */
  image-rendering: optimizeSpeed;
  /* Prevent subpixel rendering issues */
  image-rendering: -webkit-optimize-contrast;
}

/* Fix any potential overflow issues */
.xterm-container .xterm-helper-textarea {
  position: absolute;
  opacity: 0;
  left: -9999em;
  top: 0;
  width: 0;
  height: 0;
  z-index: -10;
  white-space: nowrap;
  overflow: hidden;
  resize: none;
}
